# Render Deployment Guide for JobPortal

This guide walks you through deploying the JobPortal Django application to Render.com.

## Prerequisites

- GitHub account with repository containing JobPortal code
- Render.com account (sign up at https://render.com)
- Understand basic Django and deployment concepts

## Files Included for Deployment

The following files have been added to support Render deployment:

### Configuration Files
- **`render.yaml`** - Render service configuration
- **`build.sh`** - Build script executed during deployment
- **`Procfile`** - Process file for alternative platforms
- **`runtime.txt`** - Python version specification
- **`.env.example`** - Template for environment variables
- **`.gitignore`** - Files to exclude from version control

### Updated Files
- **`requirements.txt`** - Updated with production dependencies:
  - `gunicorn` - WSGI application server
  - `whitenoise` - Static file serving
  - `dj-database-url` - Database URL parsing
  - `python-decouple` - Environment variable management
  - `psycopg2-binary` - PostgreSQL adapter

- **`job1/settings.py`** - Updated for production:
  - Environment variable support via `python-decouple`
  - PostgreSQL database support
  - Security settings (SSL, CSRF, XSS protection)
  - WhiteNoise middleware for static files
  - CSP headers configuration

## Step-by-Step Deployment

### 1. Prepare Your Local Repository

```bash
# Ensure all changes are committed
git add .
git commit -m "Prepare for Render deployment"

# Verify no uncommitted changes
git status
```

### 2. Create Render Account & Connect GitHub

1. Visit https://render.com
2. Sign up or log in with your account
3. Go to Dashboard
4. Click "New +" â†’ "Web Service"
5. Select "Build and deploy from a Git repository"
6. Connect your GitHub account
7. Authorize Render to access your repositories

### 3. Create Web Service on Render

1. **Select Repository**: Choose your JobPortal repository
2. **Configure Settings**:
   - **Name**: `jobportal` (or your preferred name)
   - **Environment**: Select `Python 3`
   - **Region**: Choose closest to you (e.g., Ohio, Singapore)
   - **Branch**: `main` (or your deployment branch)
   - **Runtime**: `python-3.11.7`
   - **Build Command**: 
     ```
     pip install -r requirements.txt && python manage.py collectstatic --noinput && python manage.py migrate
     ```
   - **Start Command**: 
     ```
     gunicorn job1.wsgi:application
     ```
   - **Plan**: Free tier available (for testing)

3. **Click "Create Web Service"**

### 4. Add Environment Variables

In the Render dashboard for your web service:

1. Go to **Environment** section
2. Add the following variables:

   ```
   DEBUG=False
   ALLOWED_HOSTS=<your-render-domain>.onrender.com
   ```

   **Important Notes**:
   - Replace `<your-render-domain>` with your actual Render domain
   - `SECRET_KEY` will be auto-generated by Render
   - `DATABASE_URL` will be added when you add PostgreSQL

### 5. Add PostgreSQL Database (Recommended)

For production, use PostgreSQL instead of SQLite:

1. In your web service dashboard, click "Add PostgreSQL"
2. Configure database:
   - **Name**: Give it a name (e.g., `jobportal-db`)
   - **Database**: `jobportal`
   - **Plan**: Free tier available
3. Click "Create Database"

**Automatically added**:
- `DATABASE_URL` environment variable will be set automatically
- Database migrations run during build

### 6. Deploy Your Application

1. **Initial Deploy**: Happens automatically after service creation
2. **Monitor Logs**: 
   - Go to "Logs" tab
   - Watch for any errors during build/deployment
3. **Check Deployment Status**:
   - Green status = successfully deployed
   - Red status = deployment failed (check logs)

### 7. Access Your Application

Once deployed successfully:

1. Your app URL: `https://<your-service-name>.onrender.com`
2. Admin panel: `https://<your-service-name>.onrender.com/admin/`

### 8. Create Superuser (First Time)

Access the web service shell to create admin user:

1. In Render dashboard, click "Shell"
2. Run:
   ```bash
   python manage.py createsuperuser
   ```
3. Follow prompts to create admin account

### 9. Configure Allowed Hosts

Update your actual domain if using custom domain:

1. Go to Environment variables
2. Update `ALLOWED_HOSTS` to include your domain
3. Redeploy the service

## Auto-Deployment from Git

After initial setup, every push to your main branch automatically triggers deployment:

```bash
# Your changes are automatically deployed
git add .
git commit -m "Update feature"
git push origin main

# Monitor in Render dashboard â†’ Deployments tab
```

## SSL/HTTPS

- âœ… Automatic SSL certificate from Render
- âœ… HTTPS enabled by default
- âœ… HTTP redirects to HTTPS automatically

## Static Files Management

- Static files are collected during build (`collectstatic`)
- Served by WhiteNoise middleware in production
- CSS, JavaScript, images automatically compressed

## Database Management

### Backup PostgreSQL Database

```bash
# From your local machine
pg_dump -h your-database-host -U username -d jobportal > backup.sql

# Or use Render's automated backups (in database settings)
```

### Access Database Directly

Get connection details from Render dashboard:
- Database host
- Username
- Password
- Database name

Connect via:
```bash
psql postgresql://username:password@host/dbname
```

## Troubleshooting

### Issue: Build fails with "ModuleNotFoundError"
**Solution**: 
- Ensure all packages are in `requirements.txt`
- Check spelling of package names
- Run locally: `pip install -r requirements.txt`

### Issue: Static files not loading (CSS/JS broken)
**Solution**:
- Ensure `collectstatic` runs in build command (it does by default)
- Check that `STATIC_URL` and `STATIC_ROOT` are correct in settings
- Verify WhiteNoise is installed and in MIDDLEWARE

### Issue: Database migrations fail
**Solution**:
- Check PostgreSQL service is running
- Verify `DATABASE_URL` environment variable is set
- Review migration files for syntax errors
- Run locally: `python manage.py migrate`

### Issue: 502 Bad Gateway error
**Solution**:
- Check application logs in Render dashboard
- Verify Gunicorn start command is correct
- Ensure no Python syntax errors
- Check required environment variables are set

### Issue: Secret files exposed
**Solution**:
- Never commit `.env` files - use `.env.example`
- Verify `.gitignore` contains sensitive files
- Rotate `SECRET_KEY` if accidentally exposed
- Use Render's environment variable management

## Performance Tips

1. **Database Indexes**: Add indexes for frequently queried fields
2. **Caching**: Implement Redis caching for expensive queries
3. **CDN**: Use CDN for static files and media
4. **Compression**: Enable gzip compression (Render does this)
5. **Database Optimization**: Use `select_related()` and `prefetch_related()`

## Scaling Your Application

### Free Tier Limits
- 0.5 CPU
- 512 MB RAM
- Sleeps after 15 mins inactivity

### Upgrade for Production
- Paid plans: always-on, more CPU/RAM
- Standard plan: recommended for production
- Professional plan: high-traffic applications

## Health Checks

Render performs health checks on your application:
- Checks every 30 seconds
- If unhealthy, restarts the service
- Configure health check path in settings if needed

## Monitoring

Monitor your application:
1. **Logs**: Real-time application logs
2. **Metrics**: CPU, memory usage
3. **Events**: Deployment history
4. **Uptime**: Service availability monitoring

## Custom Domain Setup

To use your own domain:

1. Purchase domain (GoDaddy, Namecheap, etc.)
2. In Render dashboard â†’ Settings â†’ Custom Domain
3. Add your domain
4. Update DNS records (Render provides CNAME)
5. Wait for DNS propagation (up to 48 hours)

## Securing Your Deployment

### Security Checklist
- âœ… `DEBUG = False` in production
- âœ… Strong `SECRET_KEY` (auto-generated by Render)
- âœ… HTTPS enabled (automatic)
- âœ… CSRF protection enabled
- âœ… SQL injection prevention
- âœ… XSS protection enabled
- âœ… Security headers configured
- âœ… No hardcoded credentials
- âœ… Environment variables for secrets

## Support & Resources

- Render Docs: https://render.com/docs
- Django Deployment Docs: https://docs.djangoproject.com/en/stable/howto/deployment/
- Common Issues: https://render.com/docs/troubleshooting

## Next Steps

1. âœ… Deploy your application
2. âœ… Test all features on live server
3. âœ… Configure custom domain
4. âœ… Set up monitoring alerts
5. âœ… Plan scaling strategy
6. âœ… Implement backup strategy

---

**Happy Deploying! ðŸš€**
